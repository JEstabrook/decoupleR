<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to decoupleR • decoupleR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to decoupleR">
<meta property="og:description" content="decoupleR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-11"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-11');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">decoupleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/decoupleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/saezlab/decoupleR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/saezlab">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://www.saezlab.org">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="decoupleR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="decoupleR_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="decoupleR_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to decoupleR</h1>
                        <h4 class="author">Jesús Vélez</h4>
            <address class="author_afil">
      National Autonomous University of Mexico<br><a class="author_email" href="mailto:#"></a><a href="mailto:jvelez@lcg.unam.mx" class="email">jvelez@lcg.unam.mx</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/saezlab/decoupleR/blob/master/vignettes/decoupleR.Rmd"><code>vignettes/decoupleR.Rmd</code></a></small>
      <div class="hidden name"><code>decoupleR.Rmd</code></div>

    </div>

    
    
<div id="basics" class="section level1">
<h1 class="hasAnchor">
<a href="#basics" class="anchor"></a>Basics</h1>
<div id="install-decoupler" class="section level2">
<h2 class="hasAnchor">
<a href="#install-decoupler" class="anchor"></a>Install <code>decoupleR</code>
</h2>
<p><code>R</code> is an open-source statistical environment which can be easily modified to enhance its functionality via packages. <em><a href="https://bioconductor.org/packages/3.12/decoupleR">decoupleR</a></em> is a <code>R</code> package available via the <a href="http://bioconductor.org">Bioconductor</a> repository for packages. <code>R</code> can be installed on any operating system from <a href="https://cran.r-project.org/">CRAN</a> after which you can install <em><a href="https://bioconductor.org/packages/3.12/decoupleR">decoupleR</a></em> by using the following commands in your <code>R</code> session:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"decoupleR"</span><span class="op">)</span>

<span class="co"># Check that you have a valid Bioconductor installation</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/valid.html">valid</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"saezlab/decoupleR"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"saezlab/decoupleR@devel-jesus"</span><span class="op">)</span></code></pre></div>
</div>
<div id="required-knowledge" class="section level2">
<h2 class="hasAnchor">
<a href="#required-knowledge" class="anchor"></a>Required knowledge</h2>
<p><em><a href="https://bioconductor.org/packages/3.12/decoupleR">decoupleR</a></em> is based on many other packages and in particular in those that have implemented the infrastructure needed for dealing with functional enrichment analysis. That is, packages like <em><a href="https://bioconductor.org/packages/3.12/viper">viper</a></em> or <em><a href="https://bioconductor.org/packages/3.12/GSVA">GSVA</a></em>, among others. This in order to have a centralized place from which to apply different statistics to the same data set without the need and work that would require testing in isolation. Opening the possibility of make benchmarks with easy extension.</p>
</div>
<div id="asking-for-help" class="section level2">
<h2 class="hasAnchor">
<a href="#asking-for-help" class="anchor"></a>Asking for help</h2>
<p>As package developers, we try to explain clearly how to use our packages and in which order to use the functions. But <code>R</code> and <code>Bioconductor</code> have a steep learning curve so it is critical to learn where to ask for help. We would like to highlight the <a href="https://support.bioconductor.org/">Bioconductor support site</a> as the main resource for getting help: remember to use the <code>decoupleR</code> tag and check <a href="https://support.bioconductor.org/t/decoupleR/">the older posts</a>. Other alternatives are available such as creating GitHub issues and tweeting. However, please note that if you want to receive help you should adhere to the <a href="http://www.bioconductor.org/help/support/posting-guide/">posting guidelines</a>. It is particularly critical that you provide a small reproducible example and your session information so package developers can track down the source of the error.</p>
</div>
<div id="citing-decoupler" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-decoupler" class="anchor"></a>Citing <code>decoupleR</code>
</h2>
<p>We hope that <em><a href="https://bioconductor.org/packages/3.12/decoupleR">decoupleR</a></em> will be useful for your research. Please use the following information to cite the package and the overall approach. Thank you!</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">"decoupleR"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; saezlab (2020). _Package to decouple gene sets from statistics_. doi:</span>
<span class="co">#&gt; 10.18129/B9.bioc.decoupleR (URL:</span>
<span class="co">#&gt; https://doi.org/10.18129/B9.bioc.decoupleR),</span>
<span class="co">#&gt; https://github.com/saezlab/decoupleR - R package version 0.99.0, &lt;URL:</span>
<span class="co">#&gt; http://www.bioconductor.org/packages/decoupleR&gt;.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; saezlab (2020). "Package to decouple gene sets from statistics."</span>
<span class="co">#&gt; _bioRxiv_. doi: 10.1101/TODO (URL: https://doi.org/10.1101/TODO), &lt;URL:</span>
<span class="co">#&gt; https://www.biorxiv.org/content/10.1101/TODO&gt;.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span>
<span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span>
<span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></code></pre></div>
</div>
</div>
<div id="quick-start-to-using-to-decoupler" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-start-to-using-to-decoupler" class="anchor"></a>Quick start to using to <code>decoupleR</code>
</h1>
<div id="libraries" class="section level2">
<h2 class="hasAnchor">
<a href="#libraries" class="anchor"></a>Libraries</h2>
<p><em><a href="https://bioconductor.org/packages/3.12/decoupleR">decoupleR</a></em> provides different statistics to calculate the regulatory activity given an expression <code>matrix</code> and a <code>network</code>. It incorporates pre-existing methods to avoid recreating the wheel while implementing its own methods under an evaluation standard. Therefore, it provides flexibility when evaluating a data set with different statistics.</p>
<p>Since inputs and outputs are always tibbles (i.e. special data frames), incorporating <em><a href="https://github.com/tidyverse/dplyr">dplyr</a></em> into your workflow can be useful for manipulating results, but is not necessary.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/decoupleR/">decoupleR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h2>
<p>In order to use it, you first need to have a <code>matrix</code> where the rows represent the target nodes and the columns the different conditions in which they were evaluated. In addition, it is necessary to provide a <code>network</code> that contains at least two columns corresponding to the source and target nodes. It is noteworthy that certain methods will require specifying additional metadata columns. For instance, the mode of regulation (MoR) or the likelihood of the interaction.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inputs_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"testdata"</span>, <span class="st">"inputs"</span>, package <span class="op">=</span> <span class="st">"decoupleR"</span><span class="op">)</span>

<span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">inputs_dir</span>, <span class="st">"input-expr_matrix.rds"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  num [1:18490, 1:4] 3.251 0.283 -2.253 0.782 -4.575 ...</span>
<span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   ..$ : chr [1:18490] "A1BG" "A1CF" "A2M" "A2ML1" ...</span>
<span class="co">#&gt;   ..$ : chr [1:4] "GSM2753335" "GSM2753336" "GSM2753337" "GSM2753338"</span>

<span class="va">network</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">inputs_dir</span>, <span class="st">"input-dorothea_genesets.rds"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 151</span>
<span class="co">#&gt; Columns: 5</span>
<span class="co">#&gt; $ tf         &lt;chr&gt; "FOXO4", "FOXO4", "FOXO4", "FOXO4", "FOXO4", "FOXO4", "FOX…</span>
<span class="co">#&gt; $ confidence &lt;chr&gt; "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"…</span>
<span class="co">#&gt; $ target     &lt;chr&gt; "BCL2L11", "BCL6", "CDKN1A", "CDKN1B", "G6PC", "GADD45A", …</span>
<span class="co">#&gt; $ mor        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span>
<span class="co">#&gt; $ likelihood &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></code></pre></div>
</div>
<div id="decoupling" class="section level2">
<h2 class="hasAnchor">
<a href="#decoupling" class="anchor"></a>Decoupling</h2>
<div id="how-to-decouple" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-decouple" class="anchor"></a>How to decouple?</h3>
<p>Once the data is loaded, you are one step away from achieving decoupling. This step corresponds to specifying which statistics you want to run. For more information about the defined statistics and their parameters, you can execute <code>?decouple()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/decouple.html">decouple</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="va">mat</span>,
    network <span class="op">=</span> <span class="va">network</span>,
    .source <span class="op">=</span> <span class="st">"tf"</span>,
    .target <span class="op">=</span> <span class="st">"target"</span>,
    statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gsva"</span>, <span class="st">"mean"</span>, <span class="st">"pscira"</span>, <span class="st">"scira"</span>, <span class="st">"viper"</span><span class="op">)</span>,
    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        gsva <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
        mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>.mor <span class="op">=</span> <span class="st">"mor"</span>, .likelihood <span class="op">=</span> <span class="st">"likelihood"</span><span class="op">)</span>,
        pscira <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>.mor <span class="op">=</span> <span class="st">"mor"</span><span class="op">)</span>,
        scira <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>.mor <span class="op">=</span> <span class="st">"mor"</span><span class="op">)</span>,
        viper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            .mor <span class="op">=</span> <span class="st">"mor"</span>,
            .likelihood <span class="op">=</span> <span class="st">"likelihood"</span>,
            verbose <span class="op">=</span> <span class="cn">FALSE</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">statistic_time</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 112</span>
<span class="co">#&gt; Columns: 6</span>
<span class="co">#&gt; $ run_id    &lt;chr&gt; "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1",…</span>
<span class="co">#&gt; $ statistic &lt;chr&gt; "gsva", "gsva", "gsva", "gsva", "gsva", "gsva", "gsva", "gs…</span>
<span class="co">#&gt; $ tf        &lt;chr&gt; "FOXO4", "FOXO4", "FOXO4", "FOXO4", "NFIC", "NFIC", "NFIC",…</span>
<span class="co">#&gt; $ condition &lt;chr&gt; "GSM2753335", "GSM2753336", "GSM2753337", "GSM2753338", "GS…</span>
<span class="co">#&gt; $ score     &lt;dbl&gt; -0.38043080, -0.29999174, 0.23887789, 0.09071077, -0.084521…</span>
<span class="co">#&gt; $ p_value   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></code></pre></div>
<p>Ready, you have applied different statistics to the same data set, now you can analyze them at your convenience, for example, by performing a <a href="">benchmark</a>.</p>
</div>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works?</h2>
<div id="mapping-statistics-with-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-statistics-with-arguments" class="anchor"></a>Mapping statistics with arguments</h3>
<p>Internally, <code><a href="../reference/decouple.html">decouple()</a></code> works through <code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::map2_dfr()</a></code> to perform statistics and argument mapping. This comes with important points:</p>
<ul>
<li>
<code>statistics</code> and <code>args</code> can be vectors of the same length. A vector of length 1 will be recycled. So, <strong>match</strong> is performed by <strong>position</strong> not by name. Using named vectors could be a good idea to make clear your intentions.</li>
<li>You will lose track of which statistic you are running on a certain problem. To get around this, <code><a href="../reference/decouple.html">decouple()</a></code> works with expressions that are later evaluated. For example, it generates a toy call that represents what it is trying to run. You can show it with the option <code>show_toy_call = TRUE</code>.</li>
<li>If an error occurs, copy the last line that was displayed with <code>show_toy_call = TRUE</code> and execute it locally. Try to fix it and correct it on the original call.</li>
</ul>
<p>Based on the previous points, they can take the generated toy calls and execute them independently, obtaining the same results as if you were executing <code><a href="../reference/decouple.html">decouple()</a></code>.</p>
<p>See internal gsva calls and save results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">gsvas_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decouple.html">decouple</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">5000</span><span class="op">)</span>,
    network <span class="op">=</span> <span class="va">network</span>,
    .source <span class="op">=</span> <span class="st">"tf"</span>,
    .target <span class="op">=</span> <span class="st">"target"</span>,
    statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gsva"</span><span class="op">)</span>,
    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        gsva_default <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
        gsva_minsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span>, min.sz <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
    <span class="op">)</span>,
    show_toy_call <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">statistic_time</span><span class="op">)</span>
<span class="co">#&gt; run_gsva(mat = head(mat, 5000), network = network, .source = "tf", .target = "target",verbose = FALSE)</span>
<span class="co">#&gt; run_gsva(mat = head(mat, 5000), network = network, .source = "tf", .target = "target",verbose = FALSE, min.sz = 20)</span></code></pre></div>
<p>Run same calls as provided by setting <code>show_toy_call = TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gsva_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_gsva.html">run_gsva</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">5000</span><span class="op">)</span>,
    network <span class="op">=</span> <span class="va">network</span>,
    .source <span class="op">=</span> <span class="st">"tf"</span>,
    .target <span class="op">=</span> <span class="st">"target"</span>,
    verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">gsva_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_gsva.html">run_gsva</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">5000</span><span class="op">)</span>,
    network <span class="op">=</span> <span class="va">network</span>,
    .source <span class="op">=</span> <span class="st">"tf"</span>,
    .target <span class="op">=</span> <span class="st">"target"</span>,
    verbose <span class="op">=</span> <span class="cn">FALSE</span>,
    min.sz <span class="op">=</span> <span class="fl">20</span>
<span class="op">)</span>

<span class="va">gsvas_res_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">gsva_1</span>, <span class="va">gsva_2</span>, .id <span class="op">=</span> <span class="st">"run_id"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">statistic_time</span><span class="op">)</span></code></pre></div>
<p>Now compare results and see there is not difference.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">gsvas_res</span>, <span class="va">gsvas_res_2</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="mapping-network-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-network-columns" class="anchor"></a>Mapping network columns</h3>
<p>To carry out the column mapping, <code>decoupleR</code> relies on the selection provided by the <em><a href="https://github.com/tidyverse/tidyselect">tidyselect</a></em> package. Some of the selection it provides are:</p>
<ul>
<li>Symbols</li>
<li>Strings</li>
<li>Position</li>
</ul>
<p>Let’s see an example. Input network has the following columns:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">network</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "tf"         "confidence" "target"     "mor"        "likelihood"</span></code></pre></div>
<p>We can use the way we like to do the mapping, even a combination of ways to do it. This applies not only to the decouple function, but to all functions of the <code>decoupleR statistics</code> family, identifiable by the <code>run_</code> prefix.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">this_column</span> <span class="op">&lt;-</span> <span class="st">"target"</span>
<span class="va">viper_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decouple.html">decouple</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="va">mat</span>,
    network <span class="op">=</span> <span class="va">network</span>,
    .source <span class="op">=</span> <span class="va">tf</span>,
    .target <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">this_column</span>,
    statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"viper"</span><span class="op">)</span>,
    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        viper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            .mor <span class="op">=</span> <span class="fl">4</span>,
            .likelihood <span class="op">=</span> <span class="st">"likelihood"</span>,
            verbose <span class="op">=</span> <span class="cn">FALSE</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    show_toy_call <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; run_viper(mat = mat, network = network, .source = tf, .target = "target",  .mor = 4, .likelihood = "likelihood", verbose = FALSE)</span></code></pre></div>
</div>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<pre><code>#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  setting  value                       
#&gt;  version  R version 4.0.3 (2020-10-10)
#&gt;  os       Ubuntu 20.04 LTS            
#&gt;  system   x86_64, linux-gnu           
#&gt;  ui       X11                         
#&gt;  language (EN)                        
#&gt;  collate  en_US.UTF-8                 
#&gt;  ctype    en_US.UTF-8                 
#&gt;  tz       Etc/UTC                     
#&gt;  date     2020-12-08                  
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  package              * version  date       lib source        
#&gt;  annotate               1.68.0   2020-10-27 [1] Bioconductor  
#&gt;  AnnotationDbi          1.52.0   2020-10-27 [1] Bioconductor  
#&gt;  assertthat             0.2.1    2019-03-21 [2] RSPM (R 4.0.0)
#&gt;  Biobase                2.50.0   2020-10-27 [1] Bioconductor  
#&gt;  BiocGenerics           0.36.0   2020-10-27 [1] Bioconductor  
#&gt;  BiocManager            1.30.10  2019-11-16 [2] CRAN (R 4.0.3)
#&gt;  BiocParallel           1.24.1   2020-11-06 [1] Bioconductor  
#&gt;  BiocStyle            * 2.18.1   2020-11-24 [1] Bioconductor  
#&gt;  bit                    4.0.4    2020-08-04 [1] RSPM (R 4.0.2)
#&gt;  bit64                  4.0.5    2020-08-30 [1] RSPM (R 4.0.2)
#&gt;  bitops                 1.0-6    2013-08-17 [1] RSPM (R 4.0.0)
#&gt;  blob                   1.2.1    2020-01-20 [1] RSPM (R 4.0.0)
#&gt;  bookdown               0.21     2020-10-13 [1] RSPM (R 4.0.2)
#&gt;  class                  7.3-17   2020-04-26 [3] CRAN (R 4.0.3)
#&gt;  cli                    2.2.0    2020-11-20 [2] RSPM (R 4.0.3)
#&gt;  crayon                 1.3.4    2017-09-16 [2] RSPM (R 4.0.0)
#&gt;  DBI                    1.1.0    2019-12-15 [1] RSPM (R 4.0.0)
#&gt;  decoupleR            * 0.99.0   2020-12-08 [1] Bioconductor  
#&gt;  DelayedArray           0.16.0   2020-10-27 [1] Bioconductor  
#&gt;  desc                   1.2.0    2018-05-01 [2] RSPM (R 4.0.0)
#&gt;  digest                 0.6.27   2020-10-24 [2] RSPM (R 4.0.3)
#&gt;  dplyr                * 1.0.2    2020-08-18 [1] RSPM (R 4.0.2)
#&gt;  e1071                  1.7-4    2020-10-14 [1] RSPM (R 4.0.2)
#&gt;  ellipsis               0.3.1    2020-05-15 [2] RSPM (R 4.0.0)
#&gt;  evaluate               0.14     2019-05-28 [2] RSPM (R 4.0.0)
#&gt;  fansi                  0.4.1    2020-01-08 [2] RSPM (R 4.0.0)
#&gt;  fastmatch              1.1-0    2017-01-28 [1] RSPM (R 4.0.0)
#&gt;  fs                     1.5.0    2020-07-31 [2] RSPM (R 4.0.2)
#&gt;  generics               0.1.0    2020-10-31 [1] RSPM (R 4.0.3)
#&gt;  GenomeInfoDb           1.26.1   2020-11-20 [1] Bioconductor  
#&gt;  GenomeInfoDbData       1.2.4    2020-11-27 [1] Bioconductor  
#&gt;  GenomicRanges          1.42.0   2020-10-27 [1] Bioconductor  
#&gt;  glue                   1.4.2    2020-08-27 [2] RSPM (R 4.0.2)
#&gt;  graph                  1.68.0   2020-10-27 [1] Bioconductor  
#&gt;  GSEABase               1.52.0   2020-10-27 [1] Bioconductor  
#&gt;  GSVA                   1.38.0   2020-10-27 [1] Bioconductor  
#&gt;  htmltools              0.5.0    2020-06-16 [2] RSPM (R 4.0.1)
#&gt;  httr                   1.4.2    2020-07-20 [2] RSPM (R 4.0.2)
#&gt;  IRanges                2.24.0   2020-10-27 [1] Bioconductor  
#&gt;  kernlab                0.9-29   2019-11-12 [1] RSPM (R 4.0.0)
#&gt;  KernSmooth             2.23-18  2020-10-29 [3] RSPM (R 4.0.3)
#&gt;  knitr                  1.30     2020-09-22 [2] RSPM (R 4.0.2)
#&gt;  lattice                0.20-41  2020-04-02 [3] CRAN (R 4.0.3)
#&gt;  lifecycle              0.2.0    2020-03-06 [2] RSPM (R 4.0.0)
#&gt;  magrittr               2.0.1    2020-11-17 [2] RSPM (R 4.0.3)
#&gt;  MASS                   7.3-53   2020-09-09 [3] CRAN (R 4.0.3)
#&gt;  Matrix                 1.2-18   2019-11-27 [3] CRAN (R 4.0.3)
#&gt;  MatrixGenerics         1.2.0    2020-10-27 [1] Bioconductor  
#&gt;  matrixStats            0.57.0   2020-09-25 [1] RSPM (R 4.0.2)
#&gt;  memoise                1.1.0    2017-04-21 [2] RSPM (R 4.0.0)
#&gt;  mixtools               1.2.0    2020-02-07 [1] RSPM (R 4.0.0)
#&gt;  pillar                 1.4.7    2020-11-20 [2] RSPM (R 4.0.3)
#&gt;  pkgconfig              2.0.3    2019-09-22 [2] RSPM (R 4.0.0)
#&gt;  pkgdown                1.6.1    2020-09-12 [1] RSPM (R 4.0.2)
#&gt;  purrr                  0.3.4    2020-04-17 [2] RSPM (R 4.0.0)
#&gt;  R6                     2.5.0    2020-10-28 [2] RSPM (R 4.0.3)
#&gt;  ragg                   0.4.0    2020-10-05 [1] RSPM (R 4.0.3)
#&gt;  Rcpp                   1.0.5    2020-07-06 [2] RSPM (R 4.0.2)
#&gt;  RCurl                  1.98-1.2 2020-04-18 [1] RSPM (R 4.0.0)
#&gt;  rlang                  0.4.9    2020-11-26 [2] RSPM (R 4.0.3)
#&gt;  rmarkdown              2.5      2020-10-21 [1] RSPM (R 4.0.3)
#&gt;  rprojroot              2.0.2    2020-11-15 [2] RSPM (R 4.0.3)
#&gt;  RSQLite                2.2.1    2020-09-30 [1] RSPM (R 4.0.2)
#&gt;  S4Vectors              0.28.0   2020-10-27 [1] Bioconductor  
#&gt;  segmented              1.3-0    2020-10-27 [1] RSPM (R 4.0.3)
#&gt;  sessioninfo            1.1.1    2018-11-05 [2] RSPM (R 4.0.0)
#&gt;  speedglm               0.3-2    2017-01-09 [1] RSPM (R 4.0.0)
#&gt;  stringi                1.5.3    2020-09-09 [2] RSPM (R 4.0.2)
#&gt;  stringr                1.4.0    2019-02-10 [2] RSPM (R 4.0.0)
#&gt;  SummarizedExperiment   1.20.0   2020-10-27 [1] Bioconductor  
#&gt;  survival               3.2-7    2020-09-28 [3] CRAN (R 4.0.3)
#&gt;  systemfonts            0.3.2    2020-09-29 [1] RSPM (R 4.0.3)
#&gt;  textshaping            0.2.1    2020-11-13 [1] RSPM (R 4.0.3)
#&gt;  tibble                 3.0.4    2020-10-12 [2] RSPM (R 4.0.2)
#&gt;  tidyr                  1.1.2    2020-08-27 [1] RSPM (R 4.0.3)
#&gt;  tidyselect             1.1.0    2020-05-11 [1] RSPM (R 4.0.0)
#&gt;  utf8                   1.1.4    2018-05-24 [2] RSPM (R 4.0.0)
#&gt;  vctrs                  0.3.5    2020-11-17 [2] RSPM (R 4.0.3)
#&gt;  viper                  1.24.0   2020-10-27 [1] Bioconductor  
#&gt;  withr                  2.3.0    2020-09-22 [2] RSPM (R 4.0.2)
#&gt;  xfun                   0.19     2020-10-30 [2] RSPM (R 4.0.3)
#&gt;  XML                    3.99-0.5 2020-07-23 [1] RSPM (R 4.0.2)
#&gt;  xtable                 1.8-4    2019-04-21 [1] RSPM (R 4.0.0)
#&gt;  XVector                0.30.0   2020-10-27 [1] Bioconductor  
#&gt;  yaml                   2.2.1    2020-02-01 [2] RSPM (R 4.0.0)
#&gt;  zlibbioc               1.36.0   2020-10-27 [1] Bioconductor  
#&gt; 
#&gt; [1] /__w/_temp/Library
#&gt; [2] /usr/local/lib/R/site-library
#&gt; [3] /usr/local/lib/R/library</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christian H. Holland, Jesús Vélez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
