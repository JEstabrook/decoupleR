<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Over Representation Analysis (ORA) — run_ora • decoupleR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Over Representation Analysis (ORA) — run_ora" />
<meta property="og:description" content="Calculates regulatory activities using ORA." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-11"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-11');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">decoupleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/decoupleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saezlab/decoupleR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/saezlab">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://www.saezlab.org">
    <span class="fas fa-university"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Over Representation Analysis (ORA)</h1>
    <small class="dont-index">Source: <a href='https://github.com/saezlab/decoupleR/blob/master/R/statistic-ora.R'><code>R/statistic-ora.R</code></a></small>
    <div class="hidden name"><code>run_ora.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates regulatory activities using ORA.</p>
    </div>

    <pre class="usage"><span class='fu'>run_ora</span><span class='op'>(</span>
  <span class='va'>mat</span>,
  <span class='va'>network</span>,
  .source <span class='op'>=</span> <span class='va'>.data</span><span class='op'>$</span><span class='va'>source</span>,
  .target <span class='op'>=</span> <span class='va'>.data</span><span class='op'>$</span><span class='va'>target</span>,
  n_up <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>,
  n_bottom <span class='op'>=</span> <span class='fl'>0</span>,
  n_background <span class='op'>=</span> <span class='fl'>20000</span>,
  with_ties <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat</th>
      <td><p>Matrix to evaluate (e.g. expression matrix).
Target nodes in rows and conditions in columns.
<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(mat)</a></code> must have at least one intersection with the elements
in <code>network</code> <code>.target</code> column.</p></td>
    </tr>
    <tr>
      <th>network</th>
      <td><p>Tibble or dataframe with edges and it's associated metadata.</p></td>
    </tr>
    <tr>
      <th>.source</th>
      <td><p>Column with source nodes.</p></td>
    </tr>
    <tr>
      <th>.target</th>
      <td><p>Column with target nodes.</p></td>
    </tr>
    <tr>
      <th>n_up</th>
      <td><p>Integer indicating the number of top targets to slice from mat.</p></td>
    </tr>
    <tr>
      <th>n_bottom</th>
      <td><p>Integer indicating the number of bottom targets to slice from
mat.</p></td>
    </tr>
    <tr>
      <th>n_background</th>
      <td><p>Integer indicating the background size of the sliced
targets. If not specified the number of background targets is determined by
the total number of unique targets in the union of <code>mat</code> and <code>network</code>.</p></td>
    </tr>
    <tr>
      <th>with_ties</th>
      <td><p>Should ties be kept together? The default, <code>TRUE</code>,
may return more rows than you request. Use <code>FALSE</code> to ignore ties,
and return the first <code>n</code> rows.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/r/stats/fisher.test.html'>stats::fisher.test</a></code></p><dl>
    <dt><code>workspace</code></dt><dd><p>an integer specifying the size of the workspace
    used in the network algorithm.  In units of 4 bytes.  Only used for
    non-simulated p-values larger than \(2 \times 2\) tables.
    Since <span style="R">R</span> version 3.5.0, this also increases the internal stack size
    which allows larger problems to be solved, however sometimes needing
    hours.  In such cases, <code>simulate.p.values=TRUE</code> may be more
    reasonable.</p></dd>
    <dt><code>hybrid</code></dt><dd><p>a logical. Only used for larger than \(2 \times 2\)
    tables, in which cases it indicates whether the exact probabilities
    (default) or a hybrid approximation thereof should be computed.</p></dd>
    <dt><code>hybridPars</code></dt><dd><p>a numeric vector of length 3, by default describing
    &#8220;Cochran's conditions&#8221; for the validity of the chisquare
    approximation, see &#8216;Details&#8217;.</p></dd>
    <dt><code>control</code></dt><dd><p>a list with named components for low level algorithm
    control.  At present the only one used is <code>"mult"</code>, a positive
    integer \(\ge 2\) with default 30 used only for larger than
    \(2 \times 2\) tables.  This says how many times as much
    space should be allocated to paths as to keys: see file
    <code class="file">fexact.c</code> in the sources of this package.</p></dd>
    <dt><code>or</code></dt><dd><p>the hypothesized odds ratio.  Only used in the
    \(2 \times 2\) case.</p></dd>
    <dt><code>alternative</code></dt><dd><p>indicates the alternative hypothesis and must be
    one of <code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>.
    You can specify just the initial letter.  Only used in the
    \(2 \times 2\) case.</p></dd>
    <dt><code>conf.int</code></dt><dd><p>logical indicating if a confidence interval for the
    odds ratio in a \(2 \times 2\) table should be
    computed (and returned).</p></dd>
    <dt><code>conf.level</code></dt><dd><p>confidence level for the returned confidence
    interval.  Only used in the \(2 \times 2\) case and if
    <code>conf.int = TRUE</code>.</p></dd>
    <dt><code>simulate.p.value</code></dt><dd><p>a logical indicating whether to compute
    p-values by Monte Carlo simulation, in larger than \(2 \times
      2\) tables.</p></dd>
    <dt><code>B</code></dt><dd><p>an integer specifying the number of replicates used in the
    Monte Carlo test.</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A long format tibble of the enrichment scores for each source
across the samples. Resulting tibble contains the following columns:</p><ol>
<li><p><code>statistic</code>: Indicates which method is associated with which score.</p></li>
<li><p><code>source</code>: Source nodes of <code>network</code>.</p></li>
<li><p><code>condition</code>: Condition representing each column of <code>mat</code>.</p></li>
<li><p><code>score</code>: Regulatory activity (enrichment score).</p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Performs an over-representation analysis using <code><a href='https://rdrr.io/r/stats/fisher.test.html'>stats::fisher.test()</a></code>.
Obtained scores are -log10(p-values).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other decoupleR statistics: 
<code><a href='decouple.html'>decouple</a>()</code>,
<code><a href='run_aucell.html'>run_aucell</a>()</code>,
<code><a href='run_fgsea.html'>run_fgsea</a>()</code>,
<code><a href='run_gsva.html'>run_gsva</a>()</code>,
<code><a href='run_mdt.html'>run_mdt</a>()</code>,
<code><a href='run_mlm.html'>run_mlm</a>()</code>,
<code><a href='run_udt.html'>run_udt</a>()</code>,
<code><a href='run_ulm.html'>run_ulm</a>()</code>,
<code><a href='run_viper.html'>run_viper</a>()</code>,
<code><a href='run_wmean.html'>run_wmean</a>()</code>,
<code><a href='run_wsum.html'>run_wsum</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>inputs_dir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"testdata"</span>, <span class='st'>"inputs"</span>, package <span class='op'>=</span> <span class='st'>"decoupleR"</span><span class='op'>)</span>

<span class='va'>mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>inputs_dir</span>, <span class='st'>"input-expr_matrix.rds"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>inputs_dir</span>, <span class='st'>"input-dorothea_genesets.rds"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>run_ora</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>network</span>, .source<span class='op'>=</span><span class='st'>'tf'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 20 × 5</span>
#&gt;    statistic source condition  score p_value
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> ora       FOXO4  GSM2753335 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'> 2</span> ora       FOXO4  GSM2753336 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'> 3</span> ora       FOXO4  GSM2753337 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'> 4</span> ora       FOXO4  GSM2753338 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'> 5</span> ora       NFIC   GSM2753335 0.438 0.365  
#&gt; <span style='color: #BCBCBC;'> 6</span> ora       NFIC   GSM2753336 0.438 0.365  
#&gt; <span style='color: #BCBCBC;'> 7</span> ora       NFIC   GSM2753337 0.438 0.365  
#&gt; <span style='color: #BCBCBC;'> 8</span> ora       NFIC   GSM2753338 0.438 0.365  
#&gt; <span style='color: #BCBCBC;'> 9</span> ora       RFXAP  GSM2753335 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'>10</span> ora       RFXAP  GSM2753336 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'>11</span> ora       RFXAP  GSM2753337 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'>12</span> ora       RFXAP  GSM2753338 0.477 0.333  
#&gt; <span style='color: #BCBCBC;'>13</span> ora       SMAD3  GSM2753335 1.13  0.074<span style='text-decoration: underline;'>8</span> 
#&gt; <span style='color: #BCBCBC;'>14</span> ora       SMAD3  GSM2753336 1.13  0.074<span style='text-decoration: underline;'>8</span> 
#&gt; <span style='color: #BCBCBC;'>15</span> ora       SMAD3  GSM2753337 1.13  0.074<span style='text-decoration: underline;'>8</span> 
#&gt; <span style='color: #BCBCBC;'>16</span> ora       SMAD3  GSM2753338 1.13  0.074<span style='text-decoration: underline;'>8</span> 
#&gt; <span style='color: #BCBCBC;'>17</span> ora       TFAP2A GSM2753335 2.12  0.007<span style='text-decoration: underline;'>64</span>
#&gt; <span style='color: #BCBCBC;'>18</span> ora       TFAP2A GSM2753336 2.12  0.007<span style='text-decoration: underline;'>64</span>
#&gt; <span style='color: #BCBCBC;'>19</span> ora       TFAP2A GSM2753337 2.12  0.007<span style='text-decoration: underline;'>64</span>
#&gt; <span style='color: #BCBCBC;'>20</span> ora       TFAP2A GSM2753338 2.12  0.007<span style='text-decoration: underline;'>64</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pau Badia-i-Mompel, Jesús Vélez, Jana Braunger, Celina Geiss, Daniel Dimitrov, Sophia Müller-Dott, Petr Taus, Aurélien Dugourd, Christian H. Holland, Ricardo O. Ramirez Flores, Julio Saez-Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


